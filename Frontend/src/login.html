<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>Unión Mediterránea - Taekwondo IFT</title>
    <link rel="shortcut icon" href="../assets/union.ico" type="image/x-icon">
    <link rel="stylesheet" href="../styles/login.css">
    <link rel="stylesheet" href="../styles/footer.css">
    <link rel="stylesheet" href="../styles/menu.css">
    
    
</head>
<style>
     /* Contenedor de alertas */
 .alert-container {
  position: fixed;
  bottom: 0;
  left: 0;
  display: flex;
  flex-direction: column;
  gap: 10px; /* Espacio entre las alertas */
  z-index: 1000; /* Para asegurarse de que esté encima de otros elementos */
  
}
.no-scroll {
      overflow: hidden;
  } 
/* Estilos para las alertas */
.alert {
  padding: 15px;
  width: 450px;
  border-right: 4px;
  color: #D2D2D2;
  box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.1);
}
.alert-aviso{
  background-color: #f36b2b;
  display: none;
  color: #000;
  
}
.alert-danger {
  background-color: #bd2d2a;
  display: none;
}

.alert-success {
  background-color: #2c9900;
  display: none;
}       
      
.disabled {
  opacity: 0.6;
}

.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
}

.modal-content {
    background-color: #323232 !important;
    color: #D2D2D2 !important;
    margin: 15% auto !important;
    padding: 30px !important;
    border-radius: 8px !important;
    max-width: 550px !important;
    height: 350px !important;
    position: relative !important; /* Necesario para posicionar el botón cerrar */
}

.close {
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 20px;
    cursor: pointer;
}

.label-left {
    text-align: left;
    display: block; /* Para que ocupe toda la línea y quede alineado a la izquierda */
    margin-bottom: 5px;
    margin-top: 20px;
}

.form-buttons {
    display: flex;
    justify-content: center;
    margin: 20px;
    
}
.form-buttons button {
    
    margin: 20px;
    
}

.btn-cancel {
    background-color: #63666B;
    color: #323232;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
}

.btn-cancel:hover {
    background-color: #63666B;
}
#dniInput{
    width: 100%;
}
/* Estilo del modal */
#modalTyC {
	display: none;
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	background-color: rgba(0, 0, 0, 0.5);
	justify-content: center;
	align-items: center;
	z-index: 1000;
  }

  #contenido-modal {
	background-color: #D2D2D2;
	padding: 20px;
	border-radius: 5px;
	width: 800px;
	overflow-y: auto; /* Agregamos el scroll vertical */
  }

  .cerrar {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
}

.cerrar:hover {
    color: black;
}

.terminos{
	font-size: 12px;
}

.form-group2 {
  align-items: center;
  margin-bottom: 15px;
}

.formulario__label {
  display: flex !important;
  align-items: center;
  margin: 0px !important;
  gap: 8px; /* Espacio entre el checkbox y el enlace */
  font-size: 14px;
  cursor: pointer;
}

.formulario__checkbox {
  margin: 0;
  accent-color: #D2D2D2; /* Cambia el color del checkbox si lo deseas */
}

#mostrar-terminos {
  color: #D2D2D2; /* Color del enlace */
  
}

#mostrar-terminos:hover {
  text-decoration: underline;
}
#terminos{
    width: 20px;
    margin-bottom: 0px !important;
}


</style>
<body>
    <header class="navbar">
        <div class="navbar-left">
            <a href="../Index.html">
                <img src="../assets/log4.png" alt="Logo" class="navbar-logo"> <!-- Reemplaza con la ruta de tu logo -->
                <h1 class="navbar-title">UNION MEDITERRANEA</h1>
            </a>
            
        </div>
        <nav class="navbar-menu" id="navbar-menu">
            <ul>
                <img src="../assets/log1.png" alt="Logo" class="navbar-logo-U"> <!-- Reemplaza con la ruta de tu logo -->
                <li><a href="../Index.html#Calendairo">Calendario</a></li>
                <li><a href="../Index.html#Sedes">Sedes</a></li>
                <li><a href="../Index.html#Autoridades">Autoridades</a></li>
                <li><a href="../Index.html#Galeria">Galeria</a></li>
                <li><a href="login.html" class="login-btn" id="showLoginFromMenu">Iniciar Sesión</a></li>
            </ul>
        </nav>
        <i class="fas fa-bars hamburger" id="hamburger"></i> <!-- Ícono de hamburguesa -->
    </header>
    <div class="alert-container">
        <div id="alert-aviso" class="alert alert-aviso">                
        </div>
        <div id="alert-success" class="alert alert-success">            
        </div>
        <div id="alert-error" class="alert alert-danger">
        </div>
    </div>  
    <!-- Modal Olvidé mi Contraseña -->
    <div id="forgotPasswordModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeModal">&times;</span>
            <h2>Recuperar Contraseña</h2>
            <form id="forgotPasswordForm">
                <div class="form-group">
                    <label for="dniInput" class="label-left">N° Documento</label>
                    <input type="text" id="dniInput" name="dni" placeholder="Número de documento" required>
                </div>
                <div class="form-buttons">
                    
                    <button type="button" class="btn-cancel" id="cancelModal">Cancelar</button>
                    <button type="button" class="btn-login" id="validateDni">Validar</button>
                </div>
            </form>
        </div>
    </div>

        
    <main  class="main-content">
        <div class="container">
            <h1>Unión Mediterránea</h1>
            <h2>Taekwondo IFT</h2>
            <div class="form-container" id="formContainer">
                
                <!-- Formulario de Login -->
                <form class="form login-form" id="loginForm" method="POST" action="">
                    <img src="../assets/log1.png" alt="Logo" class="logo">
                    <div class="form-group">
                        <label for="loginUsername">N° Documento</label>
                        <input type="text" id="loginUsername" name="Número de Documento" placeholder="Número de Documento" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Contraseña</label>
                        <input type="password" id="loginPassword" name="password" placeholder="Contraseña" required>
                    </div>
                    <button type="submit" class="btn-login">Ingresar</button>
                    <p class="switch-form">
                        <a href="#" id="forgotPassword">Olvidé mi contraseña</a>
                    </p>
                    <p class="switch-form">
                        ¿No tienes cuenta? <a href="#" id="showRegister">Registrarse</a>
                    </p>
                    
                </form>

                <!-- Paso 1: Datos de Usuario -->
                <div class="form register-form" id="step1Form" style="display: none;">
                    <img src="../assets/log1.png" alt="Logo" class="logo">
                    <div class="form-group">
                        <label for="tipoDocumento">Tipo de Documento</label>
                        <select id="tipoDocumento" required>
                            <option value="" disabled selected>Seleccionar tipo de documento</option>
                            <option value="DNI">DNI</option>
                            <option value="Pasaporte">Pasaporte</option>
                            <option value="CUIL">CUIL</option>
                            <option value="Cedula">Cédula de Identidad</option>
                        </select>
                        <span class="error" id="tipoDocumentoError">Debe seleccionar un tipo de documento</span>
                    </div>
                    <div class="form-group">
                        <label for="dni">N° Documento</label>
                        <input type="text" id="dni" placeholder="Número de Documento" pattern="\d{8}" required>
                        <span class="error" id="dniError">El número de documento es inválido</span>
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">Contraseña</label>
                        <input type="password" id="registerPassword" placeholder="Contraseña" pattern=".{8,}" required>
                        <span class="error" id="passwordError">La contraseña debe tener al menos 8 caracteres, debe contener letras, numeros y almenos 1 simbolo</span>
                    </div>
                    <div class="form-group">
                        <label for="repeatPassword">Repetir Contraseña</label>
                        <input type="password" id="repeatPassword" placeholder="Repetir Contraseña" required>
                        <span class="error" id="repeatPasswordError">Las contraseñas no coinciden</span>
                    </div>
                    <button type="button" class="btn-next" id="nextToStep2">Siguiente</button>
                    <p class="switch-form">
                        ¿Ya tienes cuenta? <a href="#" id="showLogin">Ingresar</a>
                    </p>
                </div>

                <!-- Paso 2: Datos Personales -->
                <div class="form register-form" id="step2Form" style="display: none;">
                    <img src="../assets/log1.png" alt="Logo" class="logo">
                    <div class="form-group">
                        <label for="firstName">Nombre</label>
                        <input type="text" id="firstName" placeholder="Nombre" pattern="[A-Za-z]{4,16}" required>
                        <span class="error" id="firstNameError">El nombre debe tener entre 4 y 16 letras</span>
                    </div>
                    <div class="form-group">
                        <label for="lastName">Apellido</label>
                        <input type="text" id="lastName" placeholder="Apellido" pattern="[A-Za-z]{4,16}" required>
                        <span class="error" id="lastNameError">El apellido debe tener entre 4 y 16 letras</span>
                    </div>
                    <div class="form-group">
                        <label for="dob">Fecha de Nacimiento</label>
                        <input type="date" id="dob" required>
                        <span class="error" id="dobError">La fecha de nacimiento es obligatoria</span>
                    </div>
                    <div class="form-group">
                        <label for="phone">Teléfono</label>
                        <input type="text" id="phone" placeholder="Teléfono" pattern="\d{10}" required>
                        <span class="error" id="phoneError">El teléfono debe tener 10 dígitos</span>
                    </div>
                    <!-- Nuevo campo de Dirección -->
                    <div class="form-group">
                        <label for="address">Dirección</label>
                        <input type="text" id="address" placeholder="Dirección" required>
                        <span class="error" id="addressError">La dirección es obligatoria</span>
                    </div>
                    <!-- Nuevo campo de Email -->
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" placeholder="Email" required>
                        <span class="error" id="emailError">Por favor, introduce un email válido</span>
                    </div>
                    <!-- Nuevo campo de Grupo Sanguíneo -->
                    <div class="form-group">
                        <label for="bloodGroup">Grupo Sanguíneo</label>
                        <select id="bloodGroup" required>
                            <option value="" disabled selected>Seleccionar grupo sanguíneo</option>
                            <option value="A+">A+</option>
                            <option value="A-">A-</option>
                            <option value="B+">B+</option>
                            <option value="B-">B-</option>
                            <option value="AB+">AB+</option>
                            <option value="AB-">AB-</option>
                            <option value="O+">O+</option>
                            <option value="O-">O-</option>
                        </select>
                        <span class="error" id="bloodGroupError">Debe seleccionar un grupo sanguíneo</span>
                    </div>
                    
                    <div class="buttons-container">
                        <button type="button" class="btn-prev" id="backToStep1">Anterior</button>
                        <button type="button" class="btn-next" id="nextToStep3">Siguiente</button>
                    </div>
                </div>
                    <!-- Paso 3: Datos del Tutor o Representante -->
                    <div class="form register-form" id="step3Form" style="display: none;">
                        <img src="../assets/log1.png" alt="Logo" class="logo">
                        <!-- Nuevo select para Tipo de Documento -->
                    <div class="form-group">
                        <label for="tipoDocumento">Tipo de Documento</label>
                        <select id="tipoDocumento" required>
                            <option value="" disabled selected>Seleccionar tipo de documento</option>
                            <option value="DNI">DNI</option>
                            <option value="Pasaporte">Pasaporte</option>
                            <option value="CUIL">CUIL</option>
                            <option value="Cedula">Cédula de Identidad</option>
                        </select>
                        <span class="error" id="tipoDocumentoError">Debe seleccionar un tipo de documento</span>
                    </div>
                    <div class="form-group">
                        <label for="tutorDNI">N° Documento</label>
                        <input type="text" id="tutorDNI" placeholder="Número de Documento" pattern="\d{8}" title="El número de documento es inválido" required>
                        <span class="error" id="tutorDNIError">El número de documento es inválido</span>
                    </div>
                    <div class="form-group">
                        <label for="tutorPhone">Teléfono del Tutor</label>
                        <input type="text" id="tutorPhone" placeholder="Teléfono del Tutor" pattern="\d{10}" title="El teléfono debe tener 10 dígitos" required>
                        <span class="error" id="tutorPhoneError">El teléfono debe tener 10 dígitos</span>
                    </div>
                    <div class="form-group">
                        <label for="tutorFirstName">Nombre del Tutor</label>
                        <input type="text" id="tutorFirstName" placeholder="Nombre del Tutor" pattern="[A-Za-z]{4,16}" required>
                        <span class="error" id="tutorFirstNameError">El nombre del tutor debe tener entre 4 y 16 letras</span>
                    </div>
                    <div class="form-group">
                        <label for="tutorLastName">Apellido del Tutor</label>
                        <input type="text" id="tutorLastName" placeholder="Apellido del Tutor" pattern="[A-Za-z]{4,16}" required>
                        <span class="error" id="tutorLastNameError">El apellido del tutor debe tener entre 4 y 16 letras</span>
                    </div>
                    <div class="form-group">
                        <label for="relationship">Relación</label>
                        <input type="text" id="relationship" placeholder="Relación" pattern="[A-Za-z\s]{4,16}" required>
                        <span class="error" id="relationshipError">La relación debe tener entre 4 y 16 letras</span>
                    </div>
                    <div class="form-group2">
                        <!-- Grupo: Términos y Condiciones -->
                        <label class="formulario__label">
                            <input class="formulario__checkbox" type="checkbox" name="terminos" id="terminos">
                            <a href="#" id="mostrar-terminos">Acepto los Términos y Condiciones</a>
                        </label>
                        <p id="terminosError" class="error">
                            Debes aceptar los Términos y Condiciones para continuar.
                        </p>
                    </div>


















                    <div class="buttons-container">
                        <button type="button" class="btn-prev" id="backToStep2">Anterior</button>
                        <button type="submit" class="btn-register" id="registerButton">Registrar</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal -->
    <div id="modalTyC">
                            
        <div id="contenido-modal">
            <span class="cerrar" onclick="cerrarModal('modalTyC')">&times;</span>
        <!-- Aquí puedes colocar el contenido de tus términos y condiciones -->
        <h2>Términos y Condiciones</h2>
        <p class="terminos">Términos y Condiciones de Uso

            Bienvenido/a a un servicio en línea que proporciona la capacidad de generar carnés para alumnos de la Union Mediterranea de Taexkwondo. Al acceder y utilizar nuestros servicios, aceptas cumplir con los siguientes términos y condiciones de uso.
            
                <br><b>Registro y Privacidad:</b>
                    Para utilizar ciertas funciones de nuestro servicio, puedes necesitar registrarte proporcionando información personal.
                    Nos comprometemos a proteger tu privacidad y a tratar tus datos de acuerdo con nuestra Política de Privacidad.
            
                <br><b>Responsabilidad del Usuario:</b>
                    Eres responsable de la exactitud de la información que proporcionas durante el registro y el uso de nuestros servicios.
                    Mantén la confidencialidad de tu información de inicio de sesión y notifícanos de cualquier uso no autorizado.
            
                <br><b>Uso Adecuado:</b>
                    No debes utilizar nuestros servicios para actividades ilegales o que violen los derechos de terceros.
                    El uso de nuestros servicios para generar carnés falsos o fraudulentos está estrictamente prohibido.
            
                <br><b>Propiedad Intelectual:</b>
                    Todos los derechos de propiedad intelectual relacionados con nuestros servicios son propiedad de Union Mediterranea de Taekwondo.
                    No tienes derecho a reproducir, modificar o distribuir nuestro contenido sin autorización.
            
                <br><b>Generación de Carnés:</b>
                    La generación de carnés se realiza con la información proporcionada por el usuario, y Union Mediterranea de Taekwondo no se hace responsable de la veracidad de dicha información.
                    Los carnés generados son responsabilidad del usuario y deben utilizarse de manera legal y ética.
            
                <br><b>Suspensión o Cancelación del Servicio:</b>
                    Nos reservamos el derecho de suspender o cancelar tu acceso a nuestros servicios en caso de incumplimiento de estos términos.
            
                <br><b>Cambios en los Términos:</b>
                    Podemos modificar estos términos en cualquier momento. Las modificaciones entrarán en vigencia inmediatamente después de la publicación en nuestro sitio web.
            
                <br><b>Ley Aplicable:</b>
                    Estos términos se rigen por las leyes de Argentina y cualquier disputa estará sujeta a la jurisdicción de los tribunales de Cordoba.
            
            <br><br><b>Al utilizar nuestros servicios, aceptas estos términos y condiciones. Si no estás de acuerdo con estos términos, te instamos a que no utilices nuestros servicios.
            
            Fecha de la última actualización: 17/3/2024</b></p>
        
        </div>
    </div>

    <footer>
        <div class="footer">
            <div class="footer-content">
                <img src="../assets/union-logo.png" alt="Logo Unión Mediterránea de Taekwondo" class="footer-logo">
            
                <div class="footer-icons-container">
                  <div class="icon-arrow">
                    <a href="#"><i class="fa-solid fa-arrow-up"></i></a>
                  </div>
                  <div class="footer-icons">
                    <a target="_blank" href="https://www.facebook.com/p/Union-Mediterranea-de-Taekwondo-100063475813834/"><i class="fa-brands fa-facebook"></i></a>
                    <a target="_blank" href="https://www.instagram.com/union_mediterranea/"><i class="fa-brands fa-instagram"></i></a>
                    <a target="_blank" href="#"><i class="fa-brands fa-youtube"></i></a>
                    <a target="_blank" href="https://wa.me/3517014308"><i class="fa-brands fa-whatsapp"></i></a>
                  </div>
                  <a href="mailto:supportunion@gmail.com" class="footer-email">supportunion@gmail.com</a>
                </div>
            
                <div class="footer-right">
                  <img src="../assets/fetra-logo.png" alt="Logo Federación Taekwondo" class="footer-logo">
                </div>
              </div>
        </div>
        

        <div class="footer-bottom">
          <p>UNION MEDITERRANEA DE TAEKWONDO 2024</p>   
        </div>
    </footer>
    <script>
		// Función para mostrar el modal
		function mostrarModal() {
		  document.getElementById('modalTyC').style.display = 'flex';
          document.body.classList.add('no-scroll'); // Bloquear el scroll
		}
	
		// Función para cerrar el modal
		function cerrarModal() {
		  document.getElementById('modalTyC').style.display = 'none';
          document.body.classList.remove('no-scroll'); // Bloquear el scroll
		}
	
		// Evento clic en el enlace
		document.getElementById('mostrar-terminos').addEventListener('click', function(event) {
		  event.preventDefault(); // Evitar que el enlace redireccione
		  mostrarModal();
		});
	  </script>
        <!-- Script para el manejo del formulario por pasos y login -->
        <script src="../controllers/form-registro.js"></script>
        <script src="../controllers/public/menu.js"></script>
  
        <script src="https://cdn.jsdelivr.net/npm/jwt-decode/build/jwt-decode.min.js"></script>
        <script>
            function handleLoginSubmit(event) {
                event.preventDefault();
        
                const dni = document.getElementById('loginUsername').value;
                const password = document.getElementById('loginPassword').value;
                const token = localStorage.getItem('authToken');
                fetch('http://localhost:3000/miembros/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        dni: dni,
                        password: password
                    })
                })
                .then(response => {
                    if (!response.ok) {
                        if (response.status === 404) {
                            showAlert('aviso', 'El DNI o la contraseña son incorrectos');
                        }
                        return response.json().then(errorData => {
                            throw new Error(errorData.message || 'Error al iniciar sesión');
                        });
                    }
                    return response.json();
                })
                .then(data => {
                    
                    if (data.token) {
                        localStorage.setItem('authToken', data.token);
        
                        const decodedToken = jwt_decode(data.token);
                        const userStatus = decodedToken.estado;
        
                        if (userStatus === false) {
                            window.location.href = 'cuotaimpaga.html'; // Redirige a la página de cobros
                        } else if (userStatus === true) {
                            showAlert('success', '¡Inicio de sesión exitoso!'); // Mensaje de éxito
                            window.location.href = 'getway.html'; // Redirige a la página de perfil
                        } else {
                            showAlert('aviso', 'Estado de usuario no reconocido');
                        }
                    } else {
                        showAlert('error', 'Credenciales incorrectas'); 
                    }
                })
                
                .catch(error => {
                    console.error('Error:', error);
                    
                });
            }
        
            // Enlaza la función al evento submit del formulario
            document.addEventListener('DOMContentLoaded', function() {
                document.getElementById('loginForm').addEventListener('submit', handleLoginSubmit);
            });
        </script>
        <!-- Script para manejar la funcionalidad -->
        <script>
            const forgotPasswordLink = document.getElementById('forgotPassword');
            const forgotPasswordModal = document.getElementById('forgotPasswordModal');
            const closeModal = document.getElementById('closeModal');
            const validateDniButton = document.getElementById('validateDni');
            const cancelModalButton = document.getElementById('cancelModal');
            const dniInput = document.getElementById('dniInput');

            // Mostrar el modal al hacer clic en "Olvidé mi contraseña"
            forgotPasswordLink.addEventListener('click', (e) => {
                e.preventDefault();
                forgotPasswordModal.style.display = 'block';
                document.body.classList.add('no-scroll'); // Bloquear el scroll
            }); 

            // Cerrar el modal al hacer clic en el botón de cerrar
            closeModal.addEventListener('click', closeForgotPasswordModal);

            // Cerrar el modal al hacer clic fuera del contenido
            window.addEventListener('click', (e) => {
                if (e.target === forgotPasswordModal) {
                    closeForgotPasswordModal();
                }
            });

            // Cerrar el modal al hacer clic en el botón Cancelar
            cancelModalButton.addEventListener('click', closeForgotPasswordModal);

            // Validar y enviar la solicitud al presionar "Validar"
            validateDniButton.addEventListener('click', async () => {
                const dni = dniInput.value.trim();

                if (!dni) {
                    showAlert('error', 'Número de documento inválido.'); 
                    return;
                }

                try {
                    const token = localStorage.getItem('authToken');
                    const response = await fetch('http://localhost:3000/miembros/solicitarCambioPassw', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                         },
                        body: JSON.stringify({ dni: dni })
                    });

                    if (response.ok) {
                        showAlert('success', 'Solicitud enviada. Revise su correo electrónico.'); // Mensaje de éxito
                        closeForgotPasswordModal();
                    } else {
                        showAlert('error','Hubo un error al procesar su solicitud. Intente nuevamente.');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showAlert('error','Hubo un error al procesar su solicitud. Intente nuevamente mas tarde.');
                }
            });

            // Función para cerrar el modal y limpiar el input
            function closeForgotPasswordModal() {
                forgotPasswordModal.style.display = 'none';
                dniInput.value = ''; // Limpiar el campo de entrada
                document.body.classList.remove('no-scroll'); // Desbloquear el scroll
            }

        </script>
    </body>
    </html>
    